import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
from scipy.stats import norm

# Data
prices = np.array([3838.45, 3816.80, 3810.75, 3787.25, 3801.70, 3815.10, 3832.05, 3878.15, 3831.65, 3852.10, 
                   3858.70, 3893.95, 3830.40, 3746.45, 3715.00, 3702.85, 3670.95, 3736.10, 3803.65, 3839.90, 
                   3847.05, 3849.50, 3893.45, 3832.00, 3820.20, 3851.45, 3834.10, 3900.95, 3880.40, 3901.20, 
                   3947.80, 3893.90, 3960.20, 3976.95, 3978.95, 3921.05, 3843.40, 3863.30, 3820.65, 3870.20, 
                   3821.35, 3852.20, 3831.05, 3874.70, 3864.60, 3826.20, 3862.00, 3872.80, 3941.20, 4001.40, 
                   3984.65, 3946.55, 3972.55, 3979.25, 4003.30, 3947.30, 3883.80, 3916.75, 3876.30, 3840.90, 
                   3877.50, 3910.90, 3972.95, 3970.90, 3977.30, 4152.50, 4219.25, 4207.60, 4149.00, 4192.25, 
                   4122.35, 4108.60, 4064.30, 4012.10, 4080.70, 4107.10, 4094.35, 4095.10, 4118.95, 4104.40, 
                   4001.05, 4052.10, 4087.10, 3991.50, 4030.65, 4103.80, 4128.30, 4103.20, 4100.10, 4149.50, 
                   4120.70, 4133.70, 4134.10, 4083.40, 4136.00, 3973.30, 3966.30, 3854.15, 3815.95, 3800.55, 
                   3801.00, 3810.30, 3841.80, 3858.25, 3860.65, 3943.05, 3902.60, 3884.60, 3861.30, 3903.80, 
                   3882.80, 3735.55, 3713.05, 3689.90, 3678.30, 3737.90, 3666.80, 3691.75, 3783.20, 3811.10, 
                   3793.40, 3799.90, 3811.20, 3795.55, 3824.00, 3787.50, 3780.05, 3816.20, 3859.20, 3861.00, 
                   3667.25, 3593.55, 3672.10, 3642.90, 3626.70, 3614.90, 3604.10, 3531.60, 3512.45, 3511.65, 
                   3487.60, 3513.75, 3470.15, 3457.10, 3508.25, 3530.15, 3510.20, 3519.60, 3502.45, 3497.85, 
                   3404.30, 3331.55, 3357.30, 3333.45, 3347.45, 3381.55, 3370.45, 3380.25, 3350.90, 3360.10, 
                   3330.65, 3368.75, 3378.55, 3350.95, 3336.75, 3390.10, 3410.15, 3494.55, 3455.65, 3487.25, 
                   3507.05, 3524.05, 3570.85, 3542.55, 3609.90, 3628.90, 3638.35, 3621.40, 3589.35, 3537.75, 
                   3513.85, 3528.60, 3536.75, 3589.30, 3585.70, 3577.15, 3603.65, 3585.30, 3606.05, 3606.15, 
                   3598.30, 3560.05, 3567.85, 3580.80, 3480.65, 3441.90, 3455.25, 3429.90, 3429.35, 3418.50, 
                   3379.20, 3356.80, 3390.95, 3376.15, 3375.55, 3381.30, 3387.75, 3398.25, 3382.15, 3401.65, 
                   3367.10, 3435.75, 3458.40, 3449.85, 3448.80, 3442.10, 3462.50, 3470.60, 3484.05, 3443.55, 
                   3399.95, 3440.65, 3452.05, 3421.45, 3355.40, 3396.90, 3388.30, 3399.15, 3394.75, 3368.30, 
                   3463.30, 3470.05, 3496.85, 3491.70, 3514.65, 3340.55, 3259.90, 3272.40, 3271.95, 3329.25, 
                   3322.90, 3319.95, 3308.85, 3272.30, 3302.25, 3215.45, 3197.35, 3189.65])
prices = prices[::-1]  # Reversing the list

# Calculate logarithmic returns
returns = np.diff(np.log(prices))

# Estimate the mean and standard deviation
mu = np.mean(returns)
sigma = np.std(returns)

# Generate values for the PDF
x = np.linspace(mu - 4 * sigma, mu + 4 * sigma, 1000)
pdf = norm.pdf(x, mu, sigma)

# Create a figure and two subplots
fig, (ax1, ax2) = plt.subplots(2, 1, figsize=(12, 10))

# First subplot: Histogram of returns and normal distribution PDF
ax1.hist(returns, bins=20, density=True, alpha=0.6, color='g', label='Histogram of Returns')
ax1.plot(x, pdf, 'k', linewidth=2, label='Normal Distribution PDF')
ax1.set_title('Stock Returns and Normal Distribution PDF')
ax1.set_xlabel('Return')
ax1.set_ylabel('Density')
ax1.legend()

# Second subplot: Line plot of the price list
ax2.plot(prices, label='Stock Prices')
ax2.set_title('Stock Prices Over Time')
ax2.set_xlabel('Time')
ax2.set_ylabel('Price')
ax2.legend()

# Adjust layout to prevent overlap
plt.tight_layout()

# Display the plots
plt.show()
